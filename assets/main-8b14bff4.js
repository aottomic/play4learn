class O{constructor(t){this.properties=t??[]}get(t){const o=this.properties.filter(n=>n.name===t).map(n=>n.value);if(o.length>1)throw new Error('Expected only one property to be named "'+t+'"');if(o.length!==0)return o[0]}getString(t){return this.getByType(t,"string")}getNumber(t){return this.getByType(t,"number")}getBoolean(t){return this.getByType(t,"boolean")}getByType(t,o){const n=this.get(t);if(n!==void 0){if(o!=="json"&&typeof n!==o)throw new Error('Expected property "'+t+'" to have type "'+o+'"');return n}}mustGetString(t){return this.mustGetByType(t,"string")}mustGetNumber(t){return this.mustGetByType(t,"number")}mustGetBoolean(t){return this.mustGetByType(t,"boolean")}mustGetByType(t,o){const n=this.get(t);if(n===void 0)throw new Error('Property "'+t+'" is missing');if(o!=="json"&&typeof n!==o)throw new Error('Expected property "'+t+'" to have type "'+o+'"');return n}getType(t){const o=this.properties.filter(n=>n.name===t).map(n=>n.type);if(o.length>1)throw new Error('Expected only one property to be named "'+t+'"');if(o.length!==0)return o[0]}}const xe="https://unpkg.com/@workadventure/scripting-api-extra@1.7.4/dist";class Xe{constructor(t){this.name=t.name,this.x=t.x,this.y=t.y,this.properties=new O(t.properties)}get isReadable(){const t=this.properties.getString("readableBy");return t?WA.player.tags.includes(t):!0}get isWritable(){const t=this.properties.getString("writableBy");return t?WA.player.tags.includes(t):!0}}function ge(e){const t=e?"#"+e.join():"";WA.nav.openCoWebSite(xe+"/configuration.html"+t,!0)}async function Qe(e,t){const o=await WA.room.getTiledMap(),n=new Map;return He(o.layers,n,e,t),n}function He(e,t,o,n){for(const r of e)if(r.type==="objectgroup"){for(const s of r.objects)if(s.type==="variable"||s.class==="variable"){if(o&&r.name!==o||n&&!n.includes(s.name))continue;t.set(s.name,new Xe(s))}}else r.type==="group"&&He(r.layers,t,o,n)}let X;async function D(){return X===void 0&&(X=Ze()),X}async function Ze(){return et(await WA.room.getTiledMap())}function et(e){const t=new Map;return De(e.layers,"",t),t}function De(e,t,o){for(const n of e)n.type==="group"?De(n.layers,t+n.name+"/",o):(n.name=t+n.name,o.set(n.name,n))}async function $e(){const e=await D(),t=[];for(const o of e.values())if(o.type==="objectgroup")for(const n of o.objects)(n.type==="area"||n.class==="area")&&t.push(n);return t}function tt(e){let t=1/0,o=1/0,n=0,r=0;const s=e.data;if(typeof s=="string")throw new Error("Unsupported tile layer data stored as string instead of CSV");for(let a=0;a<e.height;a++)for(let i=0;i<e.width;i++)s[i+a*e.width]!==0&&(t=Math.min(t,i),r=Math.max(r,i),o=Math.min(o,a),n=Math.max(n,a));return{top:o,left:t,right:r+1,bottom:n+1}}function Fe(e){let t=1/0,o=1/0,n=0,r=0;for(const s of e){const a=tt(s);a.left<t&&(t=a.left),a.top<o&&(o=a.top),a.right>r&&(r=a.right),a.bottom>n&&(n=a.bottom)}return{top:o,left:t,right:r,bottom:n}}/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */var ot=Object.prototype.toString,N=Array.isArray||function(t){return ot.call(t)==="[object Array]"};function fe(e){return typeof e=="function"}function nt(e){return N(e)?"array":typeof e}function Q(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function me(e,t){return e!=null&&typeof e=="object"&&t in e}function rt(e,t){return e!=null&&typeof e!="object"&&e.hasOwnProperty&&e.hasOwnProperty(t)}var st=RegExp.prototype.test;function at(e,t){return st.call(e,t)}var it=/\S/;function ct(e){return!at(it,e)}var lt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function ut(e){return String(e).replace(/[&<>"'`=\/]/g,function(o){return lt[o]})}var ft=/\s*/,dt=/\s+/,ye=/\s*=/,ht=/\s*\}/,pt=/#|\^|\/|>|\{|&|=|!/;function gt(e,t){if(!e)return[];var o=!1,n=[],r=[],s=[],a=!1,i=!1,c="",l=0;function d(){if(a&&!i)for(;s.length;)delete r[s.pop()];else s=[];a=!1,i=!1}var g,u,v;function E(R){if(typeof R=="string"&&(R=R.split(dt,2)),!N(R)||R.length!==2)throw new Error("Invalid tags: "+R);g=new RegExp(Q(R[0])+"\\s*"),u=new RegExp("\\s*"+Q(R[1])),v=new RegExp("\\s*"+Q("}"+R[1]))}E(t||y.tags);for(var p=new $(e),w,f,b,k,j,S;!p.eos();){if(w=p.pos,b=p.scanUntil(g),b)for(var J=0,Je=b.length;J<Je;++J)k=b.charAt(J),ct(k)?(s.push(r.length),c+=k):(i=!0,o=!0,c+=" "),r.push(["text",k,w,w+1]),w+=1,k===`
`&&(d(),c="",l=0,o=!1);if(!p.scan(g))break;if(a=!0,f=p.scan(pt)||"name",p.scan(ft),f==="="?(b=p.scanUntil(ye),p.scan(ye),p.scanUntil(u)):f==="{"?(b=p.scanUntil(v),p.scan(ht),p.scanUntil(u),f="&"):b=p.scanUntil(u),!p.scan(u))throw new Error("Unclosed tag at "+p.pos);if(f==">"?j=[f,b,w,p.pos,c,l,o]:j=[f,b,w,p.pos],l++,r.push(j),f==="#"||f==="^")n.push(j);else if(f==="/"){if(S=n.pop(),!S)throw new Error('Unopened section "'+b+'" at '+w);if(S[1]!==b)throw new Error('Unclosed section "'+S[1]+'" at '+w)}else f==="name"||f==="{"||f==="&"?i=!0:f==="="&&E(b)}if(d(),S=n.pop(),S)throw new Error('Unclosed section "'+S[1]+'" at '+p.pos);return yt(mt(r))}function mt(e){for(var t=[],o,n,r=0,s=e.length;r<s;++r)o=e[r],o&&(o[0]==="text"&&n&&n[0]==="text"?(n[1]+=o[1],n[3]=o[3]):(t.push(o),n=o));return t}function yt(e){for(var t=[],o=t,n=[],r,s,a=0,i=e.length;a<i;++a)switch(r=e[a],r[0]){case"#":case"^":o.push(r),n.push(r),o=r[4]=[];break;case"/":s=n.pop(),s[5]=r[2],o=n.length>0?n[n.length-1][4]:t;break;default:o.push(r)}return t}function $(e){this.string=e,this.tail=e,this.pos=0}$.prototype.eos=function(){return this.tail===""};$.prototype.scan=function(t){var o=this.tail.match(t);if(!o||o.index!==0)return"";var n=o[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n};$.prototype.scanUntil=function(t){var o=this.tail.search(t),n;switch(o){case-1:n=this.tail,this.tail="";break;case 0:n="";break;default:n=this.tail.substring(0,o),this.tail=this.tail.substring(o)}return this.pos+=n.length,n};function I(e,t){this.view=e,this.cache={".":this.view},this.parent=t}I.prototype.push=function(t){return new I(t,this)};I.prototype.lookup=function(t){var o=this.cache,n;if(o.hasOwnProperty(t))n=o[t];else{for(var r=this,s,a,i,c=!1;r;){if(t.indexOf(".")>0)for(s=r.view,a=t.split("."),i=0;s!=null&&i<a.length;)i===a.length-1&&(c=me(s,a[i])||rt(s,a[i])),s=s[a[i++]];else s=r.view[t],c=me(r.view,t);if(c){n=s;break}r=r.parent}o[t]=n}return fe(n)&&(n=n.call(this.view)),n};function m(){this.templateCache={_cache:{},set:function(t,o){this._cache[t]=o},get:function(t){return this._cache[t]},clear:function(){this._cache={}}}}m.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()};m.prototype.parse=function(t,o){var n=this.templateCache,r=t+":"+(o||y.tags).join(":"),s=typeof n<"u",a=s?n.get(r):void 0;return a==null&&(a=gt(t,o),s&&n.set(r,a)),a};m.prototype.render=function(t,o,n,r){var s=this.getConfigTags(r),a=this.parse(t,s),i=o instanceof I?o:new I(o,void 0);return this.renderTokens(a,i,n,t,r)};m.prototype.renderTokens=function(t,o,n,r,s){for(var a="",i,c,l,d=0,g=t.length;d<g;++d)l=void 0,i=t[d],c=i[0],c==="#"?l=this.renderSection(i,o,n,r,s):c==="^"?l=this.renderInverted(i,o,n,r,s):c===">"?l=this.renderPartial(i,o,n,s):c==="&"?l=this.unescapedValue(i,o):c==="name"?l=this.escapedValue(i,o,s):c==="text"&&(l=this.rawValue(i)),l!==void 0&&(a+=l);return a};m.prototype.renderSection=function(t,o,n,r,s){var a=this,i="",c=o.lookup(t[1]);function l(u){return a.render(u,o,n,s)}if(c){if(N(c))for(var d=0,g=c.length;d<g;++d)i+=this.renderTokens(t[4],o.push(c[d]),n,r,s);else if(typeof c=="object"||typeof c=="string"||typeof c=="number")i+=this.renderTokens(t[4],o.push(c),n,r,s);else if(fe(c)){if(typeof r!="string")throw new Error("Cannot use higher-order sections without the original template");c=c.call(o.view,r.slice(t[3],t[5]),l),c!=null&&(i+=c)}else i+=this.renderTokens(t[4],o,n,r,s);return i}};m.prototype.renderInverted=function(t,o,n,r,s){var a=o.lookup(t[1]);if(!a||N(a)&&a.length===0)return this.renderTokens(t[4],o,n,r,s)};m.prototype.indentPartial=function(t,o,n){for(var r=o.replace(/[^ \t]/g,""),s=t.split(`
`),a=0;a<s.length;a++)s[a].length&&(a>0||!n)&&(s[a]=r+s[a]);return s.join(`
`)};m.prototype.renderPartial=function(t,o,n,r){if(n){var s=this.getConfigTags(r),a=fe(n)?n(t[1]):n[t[1]];if(a!=null){var i=t[6],c=t[5],l=t[4],d=a;c==0&&l&&(d=this.indentPartial(a,l,i));var g=this.parse(d,s);return this.renderTokens(g,o,n,d,r)}}};m.prototype.unescapedValue=function(t,o){var n=o.lookup(t[1]);if(n!=null)return n};m.prototype.escapedValue=function(t,o,n){var r=this.getConfigEscape(n)||y.escape,s=o.lookup(t[1]);if(s!=null)return typeof s=="number"&&r===y.escape?String(s):r(s)};m.prototype.rawValue=function(t){return t[1]};m.prototype.getConfigTags=function(t){return N(t)?t:t&&typeof t=="object"?t.tags:void 0};m.prototype.getConfigEscape=function(t){if(t&&typeof t=="object"&&!N(t))return t.escape};var y={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){x.templateCache=e},get templateCache(){return x.templateCache}},x=new m;y.clearCache=function(){return x.clearCache()};y.parse=function(t,o){return x.parse(t,o)};y.render=function(t,o,n,r){if(typeof t!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+nt(t)+'" was given as the first argument for mustache#render(template, view, partials)');return x.render(t,o,n,r)};y.escape=ut;y.Scanner=$;y.Context=I;y.Writer=m;class Ve{constructor(t,o){this.template=t,this.state=o,this.ast=y.parse(t)}getValue(){return this.value===void 0&&(this.value=y.render(this.template,this.state)),this.value}onChange(t){const o=[];for(const n of this.getUsedVariables().values())o.push(this.state.onVariableChange(n).subscribe(()=>{const r=y.render(this.template,this.state);r!==this.value&&(this.value=r,t(this.value))}));return{unsubscribe:()=>{for(const n of o)n.unsubscribe()}}}isPureString(){return this.ast.length===0||this.ast.length===1&&this.ast[0][0]==="text"}getUsedVariables(){const t=new Set;return this.recursiveGetUsedVariables(this.ast,t),t}recursiveGetUsedVariables(t,o){for(const n of t){const r=n[0],s=n[1],a=n[4];["name","&","#","^"].includes(r)&&o.add(s),a!==void 0&&typeof a!="string"&&this.recursiveGetUsedVariables(a,o)}}}async function At(){var e;const t=await $e();for(const o of t){const n=(e=o.properties)!==null&&e!==void 0?e:[];for(const r of n){if(r.type==="int"||r.type==="bool"||r.type==="object"||typeof r.value!="string")continue;const s=new Ve(r.value,WA.state);if(s.isPureString())continue;const a=s.getValue();await Ae(o.name,r.name,a),s.onChange(async i=>{await Ae(o.name,r.name,i)})}}}async function bt(){var e;const t=await D();for(const[o,n]of t.entries())if(n.type!=="objectgroup"){const r=(e=n.properties)!==null&&e!==void 0?e:[];for(const s of r){if(s.type==="int"||s.type==="bool"||s.type==="object"||typeof s.value!="string")continue;const a=new Ve(s.value,WA.state);if(a.isPureString())continue;const i=a.getValue();be(o,s.name,i),a.onChange(c=>{be(o,s.name,c)})}}}async function Ae(e,t,o){console.log(e),(await WA.room.area.get(e)).setProperty(t,o)}function be(e,t,o){WA.room.setProperty(e,t,o),t==="visible"&&(o?WA.room.showLayer(e):WA.room.hideLayer(e))}const vt="https://admin.workadventu.re/html";let ce,de=0,he=0;function ve(e){if(WA.state[e.name]){let t=e.properties.mustGetString("openLayer");for(const o of t.split(`
`))WA.room.showLayer(o);t=e.properties.mustGetString("closeLayer");for(const o of t.split(`
`))WA.room.hideLayer(o)}else{let t=e.properties.mustGetString("openLayer");for(const o of t.split(`
`))WA.room.hideLayer(o);t=e.properties.mustGetString("closeLayer");for(const o of t.split(`
`))WA.room.showLayer(o)}}function wt(e){const t=e.properties.getString("openSound"),o=e.properties.getNumber("soundRadius");let n=1;if(o){const r=Ue(e.properties.mustGetString("openLayer").split(`
`));if(r>o)return;n=1-r/o}t&&WA.sound.loadSound(t).play({volume:n})}function Wt(e){const t=e.properties.getString("closeSound"),o=e.properties.getNumber("soundRadius");let n=1;if(o){const r=Ue(e.properties.mustGetString("closeLayer").split(`
`));if(r>o)return;n=1-r/o}t&&WA.sound.loadSound(t).play({volume:n})}function je(e){return e.map(t=>ce.get(t)).filter(t=>(t==null?void 0:t.type)==="tilelayer")}function Ue(e){const t=je(e),o=Fe(t),n=((o.right-o.left)/2+o.left)*32,r=((o.bottom-o.top)/2+o.top)*32;return Math.sqrt(Math.pow(de-n,2)+Math.pow(he-r,2))}function Et(e){WA.state.onVariableChange(e.name).subscribe(()=>{WA.state[e.name]?wt(e):Wt(e),ve(e)}),ve(e)}function we(e,t,o,n){const r=e.name;let s,a,i=!1;const c=o.getString("tag");let l=!0;c&&!WA.player.tags.includes(c)&&(l=!1);const d=!!c;function g(){var f;s&&s.remove(),s=WA.ui.displayActionMessage({message:(f=o.getString("closeTriggerMessage"))!==null&&f!==void 0?f:"Press SPACE to close the door",callback:()=>{WA.state[t.name]=!1,u()}})}function u(){var f;s&&s.remove(),s=WA.ui.displayActionMessage({message:(f=o.getString("openTriggerMessage"))!==null&&f!==void 0?f:"Press SPACE to open the door",callback:()=>{WA.state[t.name]=!0,g()}})}function v(){let f;if(e.type==="tilelayer")f=Fe(je(t.properties.mustGetString("closeLayer").split(`
`)));else{if(e.x===void 0||e.y===void 0||e.width===void 0||e.height===void 0)throw new Error(`Doorstep zone "${e.name}" is missing x, y, width or height`);f={top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}a=WA.room.website.create({name:"doorKeypad"+r,url:n+"/keypad.html#"+encodeURIComponent(r),position:{x:f.right*32,y:f.top*32,width:32*3,height:32*4},allowApi:!0})}function E(){a&&(WA.room.website.delete(a.name),a=void 0)}function p(){if(i=!0,o.getBoolean("autoOpen")&&l){WA.state[t.name]=!0;return}if(!WA.state[t.name]&&(d&&!l||!d)&&(o.getString("code")||o.getString("codeVariable"))){v();return}l&&(WA.state[t.name]?g():u())}function w(){i=!1,o.getBoolean("autoClose")&&(WA.state[t.name]=!1),s&&s.remove(),E()}e.type==="tilelayer"?(WA.room.onEnterLayer(r).subscribe(p),WA.room.onLeaveLayer(r).subscribe(w)):(WA.room.area.onEnter(r).subscribe(p),WA.room.area.onLeave(r).subscribe(w)),WA.state.onVariableChange(t.name).subscribe(()=>{i&&(!o.getBoolean("autoClose")&&WA.state[t.name]===!0&&g(),a&&WA.state[t.name]===!0&&E(),!o.getBoolean("autoOpen")&&WA.state[t.name]===!1&&u())})}function Rt(e){const t=e.properties.mustGetString("bellSound"),o=e.properties.getNumber("soundRadius");let n=1;if(o){const r=Math.sqrt(Math.pow(e.x-de,2)+Math.pow(e.y-he,2));if(r>o)return;n=1-r/o}WA.sound.loadSound(t).play({volume:n})}function Ct(e){WA.state[e.name]===void 0&&(WA.state[e.name]=0),WA.state.onVariableChange(e.name).subscribe(()=>{WA.state[e.name]&&Rt(e)})}function We(e,t,o){let n;const r=t.getString("bellPopup");if(o.type==="tilelayer"){const s=o.name;WA.room.onEnterLayer(s).subscribe(()=>{var a;r?n=WA.ui.openPopup(r,"",[{label:(a=t.getString("bellButtonText"))!==null&&a!==void 0?a:"Ring",callback:()=>{WA.state[e]=WA.state[e]+1}}]):WA.state[e]=WA.state[e]+1}),WA.room.onLeaveLayer(s).subscribe(()=>{n&&(n.close(),n=void 0)})}else{const s=o.name;WA.room.area.onEnter(s).subscribe(()=>{var a;r?n=WA.ui.openPopup(r,"",[{label:(a=t.getString("bellButtonText"))!==null&&a!==void 0?a:"Ring",callback:()=>{WA.state[e]=WA.state[e]+1}}]):WA.state[e]=WA.state[e]+1}),WA.room.area.onLeave(s).subscribe(()=>{n&&(n.close(),n=void 0)})}}async function St(e){e=e??vt;const t=await Qe();ce=await D();for(const o of t.values())o.properties.get("door")&&Et(o),o.properties.get("bell")&&Ct(o);for(const o of ce.values()){const n=new O(o.properties),r=n.getString("doorVariable");if(r&&o.type==="tilelayer"){const a=t.get(r);if(a===void 0)throw new Error('Cannot find variable "'+r+'" referred in the "doorVariable" property of layer "'+o.name+'"');we(o,a,n,e)}const s=n.getString("bellVariable");s&&o.type==="tilelayer"&&We(s,n,o)}for(const o of await $e()){const n=new O(o.properties),r=n.getString("doorVariable");if(r){const a=t.get(r);if(a===void 0)throw new Error('Cannot find variable "'+r+'" referred in the "doorVariable" property of object "'+o.name+'"');we(o,a,n,e)}const s=n.getString("bellVariable");s&&We(s,n,o)}WA.player.onPlayerMove(o=>{de=o.x,he=o.y})}function Lt(e,t){const o=e.getString("bindVariable");if(o){const n=e.get("enterValue"),r=e.get("leaveValue"),s=e.getString("triggerMessage"),a=e.getString("tag");Tt(o,t,n,r,s,a)}}function Tt(e,t,o,n,r,s){s&&!WA.player.tags.includes(s)||(o!==void 0&&WA.room.onEnterLayer(t).subscribe(()=>{r||(WA.state[e]=o)}),n!==void 0&&WA.room.onLeaveLayer(t).subscribe(()=>{WA.state[e]=n}))}async function _t(){const e=await D();for(const t of e.values()){const o=new O(t.properties);Lt(o,t.name)}}let Ee;async function Pt(e){const t=await WA.room.getTiledMap();e=e??xe,Ee=await D();const o=t.layers.find(n=>n.name==="configuration");if(o){const r=new O(o.properties).getString("tag");(!r||WA.player.tags.includes(r))&&WA.ui.registerMenuCommand("Configure the room",()=>{WA.nav.openCoWebSite(e+"/configuration.html",!0)});for(const s of Ee.values()){const a=new O(s.properties),i=a.getString("openConfig");i&&s.type==="tilelayer"&&Mt(i.split(","),s.name,a)}}}function Mt(e,t,o){let n;const r=o.getString("openConfigAdminTag");let s=!0;r&&!WA.player.tags.includes(r)&&(s=!1);function a(){var c;n&&n.remove(),n=WA.ui.displayActionMessage({message:(c=o.getString("openConfigTriggerMessage"))!==null&&c!==void 0?c:"Press SPACE or touch here to configure",callback:()=>ge(e)})}function i(){WA.nav.closeCoWebSite()}WA.room.onEnterLayer(t).subscribe(()=>{const c=o.getString("openConfigTrigger");s&&(c&&c==="onaction"?a():ge(e))}),WA.room.onLeaveLayer(t).subscribe(()=>{n&&n.remove(),i()})}function Ot(){return WA.onInit().then(()=>{St().catch(e=>console.error(e)),_t().catch(e=>console.error(e)),Pt().catch(e=>console.error(e)),bt().catch(e=>console.error(e)),At().catch(e=>console.error(e))}).catch(e=>console.error(e))}console.info("Roofs Script started successfully");let W=!0;WA.onInit().then(()=>{WA.room.area.onEnter("hallZone").subscribe(()=>{WA.room.hideLayer("roofHall")}),WA.room.area.onLeave("hallZone").subscribe(()=>{WA.room.showLayer("roofHall")}),WA.room.area.onEnter("roomsZone").subscribe(()=>{WA.room.hideLayer("roofRooms"),WA.room.hideLayer("logo-LearningCenter"),W=!1,console.log(W)}),WA.room.area.onLeave("roomsZone").subscribe(()=>{WA.room.showLayer("roofRooms"),WA.room.showLayer("logo-LearningCenter"),W=!0,console.log(W)}),WA.room.area.onEnter("1").subscribe(()=>{WA.room.hideLayer("above/aboveRoom1-Front"),WA.room.showLayer("focus/R1"),W&&(WA.room.hideLayer("roofRooms"),WA.room.hideLayer("logo-LearningCenter"),console.log("openby1"))}),WA.room.area.onLeave("1").subscribe(()=>{WA.room.showLayer("above/aboveRoom1-Front"),WA.room.hideLayer("focus/R1")}),WA.room.area.onEnter("2").subscribe(()=>{WA.room.hideLayer("above/aboveRoom2-Front"),WA.room.showLayer("focus/R2"),W&&(WA.room.hideLayer("roofRooms"),WA.room.hideLayer("logo-LearningCenter"))}),WA.room.area.onLeave("2").subscribe(()=>{WA.room.showLayer("above/aboveRoom2-Front"),WA.room.hideLayer("focus/R2")}),WA.room.area.onEnter("3").subscribe(()=>{WA.room.hideLayer("above/aboveRoom3-Front"),WA.room.showLayer("focus/R3"),W&&(WA.room.hideLayer("roofRooms"),WA.room.hideLayer("logo-LearningCenter"))}),WA.room.area.onLeave("3").subscribe(()=>{WA.room.showLayer("above/aboveRoom3-Front"),WA.room.hideLayer("focus/R3")}),WA.room.area.onEnter("4").subscribe(()=>{WA.room.hideLayer("above/aboveRoom4-Front"),WA.room.showLayer("focus/R4"),W&&(WA.room.hideLayer("roofRooms"),WA.room.hideLayer("logo-LearningCenter"))}),WA.room.area.onLeave("4").subscribe(()=>{WA.room.showLayer("above/aboveRoom4-Front"),WA.room.hideLayer("focus/R4")}),WA.room.area.onEnter("5").subscribe(()=>{WA.room.hideLayer("above/aboveRoom5-Front"),WA.room.showLayer("focus/R5"),W&&(WA.room.hideLayer("roofRooms"),WA.room.hideLayer("logo-LearningCenter"))}),WA.room.area.onLeave("5").subscribe(()=>{WA.room.showLayer("above/aboveRoom5-Front"),WA.room.hideLayer("focus/R5")}),WA.room.area.onEnter("6").subscribe(()=>{WA.room.hideLayer("above/aboveRoom6-Front"),WA.room.showLayer("focus/R6"),W&&(WA.room.hideLayer("roofRooms"),WA.room.hideLayer("logo-LearningCenter"))}),WA.room.area.onLeave("6").subscribe(()=>{WA.room.showLayer("above/aboveRoom6-Front"),WA.room.hideLayer("focus/R6")})}).catch(e=>console.error(e));console.info("Actions Script started successfully");let q,h,Re=0,U=!1,le=255,Ce=!0,Z=!1,ee=!1,te=!1,oe=!1,ne=!1;WA.onInit().then(()=>{WA.room.area.onEnter("P1").subscribe(()=>{h=WA.ui.displayActionMessage({message:`Press 'Spacebar' OR 'Click' 
to 'Hall' room `,callback:()=>{WA.nav.goToRoom("#H1"),console.log("Portal1 to Hall1")}})}),WA.room.area.onEnter("P2").subscribe(()=>{h=WA.ui.displayActionMessage({message:`Press 'Spacebar' OR 'Click' 
to 'CPW Hall of Fame' room `,callback:()=>{WA.nav.goToRoom("#R2"),console.log("Portal2 to Room2")}})}),WA.room.area.onEnter("P3").subscribe(()=>{h=WA.ui.displayActionMessage({message:`Press 'Spacebar' OR 'Click' 
to 'CPW Pitching 2022' room `,callback:()=>{WA.nav.goToRoom("#R3"),console.log("Portal3 to Room3")}})}),WA.room.area.onEnter("P4").subscribe(()=>{h=WA.ui.displayActionMessage({message:`Press 'Spacebar' OR 'Click' 
to 'A-Gadgets' room `,callback:()=>{WA.nav.goToRoom("#R4"),console.log("Portal4 to Room4")}})}),WA.room.area.onEnter("P5").subscribe(()=>{h=WA.ui.displayActionMessage({message:`Press 'Spacebar' OR 'Click' 
to 'B-Competitive Game' room `,callback:()=>{WA.nav.goToRoom("#R5"),console.log("Portal5 to Room5")}})}),WA.room.area.onEnter("P6").subscribe(()=>{h=WA.ui.displayActionMessage({message:`Press 'Spacebar' OR 'Click' 
to 'C-Self Entertain' room `,callback:()=>{WA.nav.goToRoom("#R6"),console.log("Portal6 to Room")}})}),WA.room.area.onLeave("P1").subscribe(()=>{h!==void 0&&h.remove()}),WA.room.area.onLeave("P2").subscribe(()=>{h!==void 0&&h.remove()}),WA.room.area.onLeave("P3").subscribe(()=>{h!==void 0&&h.remove()}),WA.room.area.onLeave("P4").subscribe(()=>{h!==void 0&&h.remove()}),WA.room.area.onLeave("P5").subscribe(()=>{h!==void 0&&h.remove()}),WA.room.area.onLeave("P6").subscribe(()=>{h!==void 0&&h.remove()}),WA.room.area.onEnter("RoomL").subscribe(()=>{h=WA.ui.displayActionMessage({message:`Press 'Spacebar' OR 'Click' 
to Right side`,callback:()=>{WA.nav.goToRoom("#RoomR"),console.log("Left to Right side")}})}),WA.room.area.onEnter("RoomR").subscribe(()=>{h=WA.ui.displayActionMessage({message:`Press 'Spacebar' OR 'Click' 
to Left side`,callback:()=>{WA.nav.goToRoom("#RoomL"),console.log("Right to Left side")}})}),WA.room.area.onLeave("RoomL").subscribe(()=>{h!==void 0&&h.remove()}),WA.room.area.onLeave("RoomR").subscribe(()=>{h!==void 0&&h.remove()}),WA.room.onEnterLayer("start").subscribe(()=>{Re++,console.log(Re)}),WA.room.area.onEnter("title_zone").subscribe(()=>{U||(WA.state.countPlayers++,U=!0),console.log(WA.state.countPlayers)}),WA.room.area.onEnter("checkCountPlayers").subscribe(()=>{U||(WA.state.countPlayers++,U=!0),console.log("alertVar is "+WA.state.alertVar),console.log("alert is "+le),console.log(WA.state.countPlayers)}),WA.room.onEnterLayer("walk/1").subscribe(()=>{Ce&&(WA.room.hideLayer("walk/1"),WA.room.showLayer("walk/2"),Ce=!1,Z=!0)}),WA.room.onEnterLayer("walk/2").subscribe(()=>{Z&&(WA.room.hideLayer("walk/2"),WA.room.showLayer("walk/3"),Z=!1,ee=!0)}),WA.room.onEnterLayer("walk/3").subscribe(()=>{ee&&(WA.room.hideLayer("walk/3"),WA.room.showLayer("walk/4"),ee=!1,te=!0)}),WA.room.onEnterLayer("walk/4").subscribe(()=>{te&&(WA.room.hideLayer("walk/4"),WA.room.showLayer("walk/5"),te=!1,oe=!0)}),WA.room.onEnterLayer("walk/5").subscribe(()=>{oe&&(WA.room.hideLayer("walk/5"),WA.room.showLayer("walk/6"),oe=!1,ne=!0)}),WA.room.onEnterLayer("walk/6").subscribe(()=>{ne&&(WA.room.hideLayer("walk/6"),ne=!1)}),WA.room.area.onLeave("alerttest").subscribe(()=>{le=WA.state.alertVar,WA.room.hideLayer("alert")}),WA.room.area.onEnter("alerttest").subscribe(()=>{WA.state.alertVar++}),Ke(),WA.room.area.onEnter("title_zone").subscribe(()=>{const e=new Date,t=e.getHours()+":"+e.getMinutes();console.log("titlezone"),q=WA.ui.openPopup("title_pop",`Welcome to Learning Center!! 
 at `+t+" NOW HAVING "+WA.state.countPlayers+" Players",[])}),WA.room.area.onLeave("title_zone").subscribe(It)}).catch(e=>console.error(e));const Ke=()=>{WA.state.alertVar!==le?WA.room.showLayer("alert"):WA.room.hideLayer("alert"),setTimeout(Ke,1500)};function It(){q!==void 0&&(q.close(),q=void 0)}console.log("Funnel script loaded");const Nt=()=>{WA.ui.modal.openModal({title:"Review",src:"https://padlet.com/embed/tk2fbn34hg15d58j/slideshow?autoplay=1&loop=1",allow:"fullscreen; clipboard-read; clipboard-write",allowApi:!0,position:"center"})},kt=()=>{WA.ui.modal.openModal({title:"Review",src:"https://padlet.com/aonparrot/submission-request/1OL2bZnNAM9lbaK3",allow:"fullscreen; clipboard-read; clipboard-write",allowApi:!0,position:"center"})};WA.onInit().then(()=>{WA.room.area.onEnter("gameHall_zone").subscribe(()=>{WA.ui.modal.closeModal(),Nt()}),WA.room.area.onLeave("gameHall_zone").subscribe(()=>{WA.ui.modal.closeModal()}),WA.room.area.onEnter("alerttest").subscribe(()=>{WA.ui.modal.closeModal(),kt()}),WA.room.area.onLeave("alerttest").subscribe(()=>{WA.ui.modal.closeModal()})});console.info("Bot Script started successfully");WA.room.area.onEnter("bot_spawn").subscribe(()=>{WA.nav.goToRoom("#"),setTimeout(()=>{WA.onInit().then(()=>{console.log("Get Script"),qe()})},1e3)});let G=4600,B=1900;function qe(){console.log("Start Walking");const e=Math.floor(Math.random()*700)-350,t=Math.floor(Math.random()*700)-350;G+=e,B+=t,B>2440&&(B=2420),G>4840&&(G=4780),WA.player.moveTo(G,B,10),setTimeout(function(){WA.onInit().then(async()=>{console.log("St Position : ",await WA.player.getPosition())}),console.log("to Position X: ",G),console.log("to Position Y: ",B),qe()},Math.floor(Math.random()*4e3)+6e3)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Se=["user","model","function"];var Le;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT"})(Le||(Le={}));var Te;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(Te||(Te={}));var _e;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(_e||(_e={}));var Pe;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER"})(Pe||(Pe={}));var Y;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.OTHER="OTHER"})(Y||(Y={}));var Me;(function(e){e.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",e.RETRIEVAL_QUERY="RETRIEVAL_QUERY",e.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",e.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",e.CLASSIFICATION="CLASSIFICATION",e.CLUSTERING="CLUSTERING"})(Me||(Me={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Oe;(function(e){e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT"})(Oe||(Oe={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A extends Error{constructor(t){super(`[GoogleGenerativeAI Error]: ${t}`)}}class K extends A{constructor(t,o){super(t),this.response=o}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gt="https://generativelanguage.googleapis.com",Bt="v1",xt="0.3.1",Ht="genai-js";var T;(function(e){e.GENERATE_CONTENT="generateContent",e.STREAM_GENERATE_CONTENT="streamGenerateContent",e.COUNT_TOKENS="countTokens",e.EMBED_CONTENT="embedContent",e.BATCH_EMBED_CONTENTS="batchEmbedContents"})(T||(T={}));class F{constructor(t,o,n,r,s){this.model=t,this.task=o,this.apiKey=n,this.stream=r,this.requestOptions=s}toString(){var t;const o=((t=this.requestOptions)===null||t===void 0?void 0:t.apiVersion)||Bt;let n=`${Gt}/${o}/${this.model}:${this.task}`;return this.stream&&(n+="?alt=sse"),n}}function Dt(){return`${Ht}/${xt}`}async function V(e,t,o){let n;try{if(n=await fetch(e.toString(),Object.assign(Object.assign({},$t(o)),{method:"POST",headers:{"Content-Type":"application/json","x-goog-api-client":Dt(),"x-goog-api-key":e.apiKey},body:t})),!n.ok){let r="";try{const s=await n.json();r=s.error.message,s.error.details&&(r+=` ${JSON.stringify(s.error.details)}`)}catch{}throw new Error(`[${n.status} ${n.statusText}] ${r}`)}}catch(r){const s=new A(`Error fetching from ${e.toString()}: ${r.message}`);throw s.stack=r.stack,s}return n}function $t(e){const t={};if((e==null?void 0:e.timeout)>=0){const o=new AbortController,n=o.signal;setTimeout(()=>o.abort(),e.timeout),t.signal=n}return t}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pe(e){return e.text=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),ue(e.candidates[0]))throw new K(`${M(e)}`,e);return Ft(e)}else if(e.promptFeedback)throw new K(`Text not available. ${M(e)}`,e);return""},e.functionCall=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function call from the first candidate only. Access response.candidates directly to use the other candidates.`),ue(e.candidates[0]))throw new K(`${M(e)}`,e);return Vt(e)}else if(e.promptFeedback)throw new K(`Function call not available. ${M(e)}`,e)},e}function Ft(e){var t,o,n,r;return!((r=(n=(o=(t=e.candidates)===null||t===void 0?void 0:t[0].content)===null||o===void 0?void 0:o.parts)===null||n===void 0?void 0:n[0])===null||r===void 0)&&r.text?e.candidates[0].content.parts.map(({text:s})=>s).join(""):""}function Vt(e){var t,o,n,r;return(r=(n=(o=(t=e.candidates)===null||t===void 0?void 0:t[0].content)===null||o===void 0?void 0:o.parts)===null||n===void 0?void 0:n[0])===null||r===void 0?void 0:r.functionCall}const jt=[Y.RECITATION,Y.SAFETY];function ue(e){return!!e.finishReason&&jt.includes(e.finishReason)}function M(e){var t,o,n;let r="";if((!e.candidates||e.candidates.length===0)&&e.promptFeedback)r+="Response was blocked",!((t=e.promptFeedback)===null||t===void 0)&&t.blockReason&&(r+=` due to ${e.promptFeedback.blockReason}`),!((o=e.promptFeedback)===null||o===void 0)&&o.blockReasonMessage&&(r+=`: ${e.promptFeedback.blockReasonMessage}`);else if(!((n=e.candidates)===null||n===void 0)&&n[0]){const s=e.candidates[0];ue(s)&&(r+=`Candidate was blocked due to ${s.finishReason}`,s.finishMessage&&(r+=`: ${s.finishMessage}`))}return r}function H(e){return this instanceof H?(this.v=e,this):new H(e)}function Ut(e,t,o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=o.apply(e,t||[]),r,s=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(u){n[u]&&(r[u]=function(v){return new Promise(function(E,p){s.push([u,v,E,p])>1||i(u,v)})})}function i(u,v){try{c(n[u](v))}catch(E){g(s[0][3],E)}}function c(u){u.value instanceof H?Promise.resolve(u.value.v).then(l,d):g(s[0][2],u)}function l(u){i("next",u)}function d(u){i("throw",u)}function g(u,v){u(v),s.shift(),s.length&&i(s[0][0],s[0][1])}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ie=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function Kt(e){const t=e.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),o=zt(t),[n,r]=o.tee();return{stream:Yt(n),response:qt(r)}}async function qt(e){const t=[],o=e.getReader();for(;;){const{done:n,value:r}=await o.read();if(n)return pe(Jt(t));t.push(r)}}function Yt(e){return Ut(this,arguments,function*(){const o=e.getReader();for(;;){const{value:n,done:r}=yield H(o.read());if(r)break;yield yield H(pe(n))}})}function zt(e){const t=e.getReader();return new ReadableStream({start(n){let r="";return s();function s(){return t.read().then(({value:a,done:i})=>{if(i){if(r.trim()){n.error(new A("Failed to parse stream"));return}n.close();return}r+=a;let c=r.match(Ie),l;for(;c;){try{l=JSON.parse(c[1])}catch{n.error(new A(`Error parsing JSON response: "${c[1]}"`));return}n.enqueue(l),r=r.substring(c[0].length),c=r.match(Ie)}return s()})}}})}function Jt(e){const t=e[e.length-1],o={promptFeedback:t==null?void 0:t.promptFeedback};for(const n of e)if(n.candidates)for(const r of n.candidates){const s=r.index;if(o.candidates||(o.candidates=[]),o.candidates[s]||(o.candidates[s]={index:r.index}),o.candidates[s].citationMetadata=r.citationMetadata,o.candidates[s].finishReason=r.finishReason,o.candidates[s].finishMessage=r.finishMessage,o.candidates[s].safetyRatings=r.safetyRatings,r.content&&r.content.parts){o.candidates[s].content||(o.candidates[s].content={role:r.content.role||"user",parts:[]});const a={};for(const i of r.content.parts)i.text&&(a.text=i.text),i.functionCall&&(a.functionCall=i.functionCall),Object.keys(a).length===0&&(a.text=""),o.candidates[s].content.parts.push(a)}}return o}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ye(e,t,o,n){const r=new F(t,T.STREAM_GENERATE_CONTENT,e,!0,n),s=await V(r,JSON.stringify(o),n);return Kt(s)}async function ze(e,t,o,n){const r=new F(t,T.GENERATE_CONTENT,e,!1,n),a=await(await V(r,JSON.stringify(o),n)).json();return{response:pe(a)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z(e){let t=[];if(typeof e=="string")t=[{text:e}];else for(const o of e)typeof o=="string"?t.push({text:o}):t.push(o);return Xt(t)}function Xt(e){const t={role:"user",parts:[]},o={role:"function",parts:[]};let n=!1,r=!1;for(const s of e)"functionResponse"in s?(o.parts.push(s),r=!0):(t.parts.push(s),n=!0);if(n&&r)throw new A("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!n&&!r)throw new A("No content is provided for sending chat message.");return n?t:o}function re(e){return e.contents?e:{contents:[z(e)]}}function Qt(e){return typeof e=="string"||Array.isArray(e)?{content:z(e)}:e}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ne=["text","inlineData","functionCall","functionResponse"],Zt={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall"]},ke={user:["model"],function:["model"],model:["user","function"]};function eo(e){let t;for(const o of e){const{role:n,parts:r}=o;if(!t&&n!=="user")throw new A(`First content should be with role 'user', got ${n}`);if(!Se.includes(n))throw new A(`Each item should include role field. Got ${n} but valid roles are: ${JSON.stringify(Se)}`);if(!Array.isArray(r))throw new A("Content should have 'parts' property with an array of Parts");if(r.length===0)throw new A("Each Content should have at least one part");const s={text:0,inlineData:0,functionCall:0,functionResponse:0};for(const i of r)for(const c of Ne)c in i&&(s[c]+=1);const a=Zt[n];for(const i of Ne)if(!a.includes(i)&&s[i]>0)throw new A(`Content with role '${n}' can't contain '${i}' part`);if(t&&!ke[n].includes(t.role))throw new A(`Content with role '${n}' can't follow '${t.role}'. Valid previous roles: ${JSON.stringify(ke)}`);t=o}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ge="SILENT_ERROR";class to{constructor(t,o,n,r){this.model=o,this.params=n,this.requestOptions=r,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=t,n!=null&&n.history&&(eo(n.history),this._history=n.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(t){var o,n,r;await this._sendPromise;const s=z(t),a={safetySettings:(o=this.params)===null||o===void 0?void 0:o.safetySettings,generationConfig:(n=this.params)===null||n===void 0?void 0:n.generationConfig,tools:(r=this.params)===null||r===void 0?void 0:r.tools,contents:[...this._history,s]};let i;return this._sendPromise=this._sendPromise.then(()=>ze(this._apiKey,this.model,a,this.requestOptions)).then(c=>{var l;if(c.response.candidates&&c.response.candidates.length>0){this._history.push(s);const d=Object.assign({parts:[],role:"model"},(l=c.response.candidates)===null||l===void 0?void 0:l[0].content);this._history.push(d)}else{const d=M(c.response);d&&console.warn(`sendMessage() was unsuccessful. ${d}. Inspect response object for details.`)}i=c}),await this._sendPromise,i}async sendMessageStream(t){var o,n,r;await this._sendPromise;const s=z(t),a={safetySettings:(o=this.params)===null||o===void 0?void 0:o.safetySettings,generationConfig:(n=this.params)===null||n===void 0?void 0:n.generationConfig,tools:(r=this.params)===null||r===void 0?void 0:r.tools,contents:[...this._history,s]},i=Ye(this._apiKey,this.model,a,this.requestOptions);return this._sendPromise=this._sendPromise.then(()=>i).catch(c=>{throw new Error(Ge)}).then(c=>c.response).then(c=>{if(c.candidates&&c.candidates.length>0){this._history.push(s);const l=Object.assign({},c.candidates[0].content);l.role||(l.role="model"),this._history.push(l)}else{const l=M(c);l&&console.warn(`sendMessageStream() was unsuccessful. ${l}. Inspect response object for details.`)}}).catch(c=>{c.message!==Ge&&console.error(c)}),i}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oo(e,t,o,n){const r=new F(t,T.COUNT_TOKENS,e,!1,{});return(await V(r,JSON.stringify(Object.assign(Object.assign({},o),{model:t})),n)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function no(e,t,o,n){const r=new F(t,T.EMBED_CONTENT,e,!1,{});return(await V(r,JSON.stringify(o),n)).json()}async function ro(e,t,o,n){const r=new F(t,T.BATCH_EMBED_CONTENTS,e,!1,{}),s=o.requests.map(i=>Object.assign(Object.assign({},i),{model:t}));return(await V(r,JSON.stringify({requests:s}),n)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so{constructor(t,o,n){this.apiKey=t,o.model.includes("/")?this.model=o.model:this.model=`models/${o.model}`,this.generationConfig=o.generationConfig||{},this.safetySettings=o.safetySettings||[],this.tools=o.tools,this.requestOptions=n||{}}async generateContent(t){const o=re(t);return ze(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools},o),this.requestOptions)}async generateContentStream(t){const o=re(t);return Ye(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools},o),this.requestOptions)}startChat(t){return new to(this.apiKey,this.model,Object.assign({tools:this.tools},t),this.requestOptions)}async countTokens(t){const o=re(t);return oo(this.apiKey,this.model,o)}async embedContent(t){const o=Qt(t);return no(this.apiKey,this.model,o)}async batchEmbedContents(t){return ro(this.apiKey,this.model,t,this.requestOptions)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(t){this.apiKey=t}getGenerativeModel(t,o){if(!t.model)throw new A("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new so(this.apiKey,t,o)}}const io=new ao("AIzaSyCjSWKop9h4C9iZHHaTVwhRA340Awbj0gY");async function co(e){return console.log("asdadas"),(await(await io.getGenerativeModel({model:"gemini-pro"}).generateContent(e+" **ตอบไม่เกิน150ตัวอักษร")).response).text()}console.info("Chat Script started successfully");let _=!1;WA.onInit().then(()=>{console.log("chat :",_),WA.room.area.onEnter("chatZone").subscribe(()=>{WA.chat.sendChatMessage("สวัสดีครับ มีอะไรให้ช่วยไหมครับ?","เอไอ"),_=!0,WA.chat.open(),console.log("เข้าร่วมการแชท:",_)}),WA.room.area.onLeave("chatZone").subscribe(()=>{_=!1,WA.chat.close(),console.log("ออกจากการแชท:",_)}),WA.chat.onChatMessage(e=>{_&&(WA.chat.startTyping({scope:"local",author:"เอไอ"}),co(e).then(t=>{WA.chat.sendChatMessage(t,"เอไอ"),WA.chat.stopTyping({scope:"local"})}))})}).catch(e=>console.error(e));const C=[{question:"PPB ย่อมาจากคำภาษาอังกฤษว่า",answerType:"all",answer:["Parts","per","Billion"]},{question:"ความเข้มข้น 1 PPB (1 ส่วนในพันล้านส่วน) กับ 1 PPM (1 ส่วนในล้านส่วน) ความเข้มข้นใด มีความเข้มข้นมากกว่า",answerType:"any",answer:["1 PPM","PPM","Ppm","หนึ่งในล้านส่วน","หนึ่งส่วนในล้านส่วน","1/ล้าน"]},{question:"Arsenic เข้าสู่ร่างกายทางอวัยวะส่วนใดได้บ้าง",answerType:"any",answer:["ผิวหนัง","การสัมผัส","การหายใจ","จมูก","ปาก","การรับประทานอาหารที่ปนเปื้อน","การดื่มน้ำที่ปนเปื้อน"]},{question:"Arsenic ในธรรมชาติมาจากอะไรได้บ้าง",answerType:"any",answer:["ตอบอันใดอันหนึ่งต่อไปนี้","การชะล้างของหิน","ภูเขาไฟ","เปลือกโลก","การทำแหมืองเร่","โรงงานอุตสาหกรรม","การใช้ปุ๋ยและยาฆ่าแมลง","การผสมในอาหาร","การผลิตยา"]}];console.info("The Quiz Script has successfully begun!");let P=!1,se=0,L=0;C.sort(()=>Math.random()-.5);WA.onInit().then(()=>{console.log("quiz :",P),WA.room.area.onEnter("quizZone").subscribe(()=>{WA.chat.sendChatMessage("Welcome to the Exam!","Teacher"),P=!0,console.log("Join quiz:",P),WA.chat.open(),t()}),WA.room.area.onLeave("quizZone").subscribe(()=>{P=!1,console.log("Leave quiz:",P),WA.chat.close()});const e=(n,r="Quiz")=>{WA.chat.sendChatMessage(n,r)},t=()=>{if(L>=C.length){e(`Exam completed! Your score is ${se} out of ${C.length}`,"Teacher");return}const n=C[L];e(n.question,"Teacher")};WA.chat.onChatMessage(n=>{P&&(L<C.length?o(n):(e(`Your score is ${se} out of ${C.length}`,"Teacher"),e("Exam is over. You can leave the quiz zone now.","Teacher")))});const o=n=>{const r=n.trim().toLowerCase().split(" "),s=C[L].answer.map(i=>i.toLowerCase());let a=!1;switch(C[L].answerType){case"any":for(const i of r)if(s.includes(i)){a=!0;break}break;case"all":a=r.length===s.length&&r.every(i=>s.includes(i));break;default:console.error("Invalid answerType:",C[L].answerType)}a?(se++,e("Correct!","Teacher"),L++,t()):(e("Incorrect!","Teacher"),t())}}).catch(e=>console.error(e));const lo=[{zone:"a",value:[1,2,3,4,5,6,7,8,9,10,11,12,13,14]},{zone:"b",value:[,2,3,3,,,6,7,8,9,,11,12]},{zone:"c",value:[,2,3,3,,,6,7,8,9,,11,12]},{zone:"d",value:[,2,3,3,,,6,7,8,9,,11,12]},{zone:"e",value:[,2,3,3,,,6,7,8,9,,11,12]},{zone:"g",value:[,2,3,3,,,6,7,8,9,,11,12]},{zone:"h",value:[,2,3,3,,,6,7,8,9,,11,12]}];console.log("BoradGame Run");let Be=!1;WA.onInit().then(()=>{let e;Be==!1&&lo.forEach(t=>{const o=t.zone;t.value.forEach((n,r)=>{const s=`${o}${r+1}`,a=t.value[r];WA.room.area.onEnter(s+"f").subscribe(()=>{WA.state[s]?e=WA.ui.displayActionMessage({message:`${s} It has already been explored.  
              [Click]`,callback:()=>{e.remove()}}):e=WA.ui.displayActionMessage({message:`${s} Explore this area.  
                [Click]`,callback:()=>{console.log(`survey ${s}`),console.log(`value is ${a}`),Be=!0,WA.state[s]=!0,console.log(`${s} done`,WA.state[s])}})}),WA.room.area.onLeave(s+"f").subscribe(()=>{e.remove()})})})}).catch(e=>console.error(e));console.log("Script started successfully");let ae=!1,ie=!1;WA.onInit().then(async()=>{console.log("Scripting API ready"),await WA.players.configureTracking();const e=WA.players.list();console.log(e);for(const n of e)console.log(`Player ${n.name} is near you`);console.log("Token: ",WA.player.userRoomToken),console.log("Player name: ",WA.player.name),console.log("Player tags: ",WA.player.tags),console.log("Player ID: ",WA.player.id),WA.ui.actionBar.addButton({id:"btn-poll-a",type:"action",imageSrc:"https://i.ibb.co/8452NqN/rocket-lunchx.png",toolTip:"MINI MAP",callback:()=>{if(ae){WA.ui.modal.closeModal(),ae=!1;return}t(),ae=!0}});const t=async()=>{WA.ui.modal.closeModal(),WA.ui.modal.openModal({src:"https://i.ibb.co/QXhXY8R/Screenshot-2567-03-01-at-09-37-21.png",allow:"",title:"website",allowApi:!0,position:"center"})};WA.ui.actionBar.addButton({id:"btn-form",type:"action",imageSrc:"https://i.ibb.co/JFXcrqH/computerx.png",toolTip:"Questionnaire",callback:()=>{if(ie){WA.ui.modal.closeModal(),ie=!1;return}o(),ie=!0}});const o=async()=>{WA.ui.modal.closeModal(),WA.ui.modal.openModal({src:"https://docs.google.com/forms/d/e/1FAIpQLSfsBAyWHjq2h6Mo7YZJKPZQV025nn6saqe4BCsgE20aucU07w/viewform?embedded=true",allow:"fullscreen",title:"website",allowApi:!0,position:"center"})};Ot().then(()=>{console.log("Scripting API Extra ready")}).catch(n=>console.error(n))}).catch(e=>console.error(e));
